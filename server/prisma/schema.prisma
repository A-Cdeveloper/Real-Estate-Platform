generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  // Prisma 6.18.0 requires url in schema - Prisma 7 warning is false positive
  url      = env("DATABASE_URL")
}

enum PropertyType {
  Apartment
  House
  Commercial
}

enum PropertyStatus {
  APPROVED
  IN_REVIEW
  REJECTED
}

enum Role {
  ADMIN
  AGENT
}

model User {
  id                       String     @id @default(cuid()) // unikatan string ID
  email                    String     @unique
  password                 String
  name                     String?
  role                     Role
  isActive                 Boolean    @default(true)
  isOnline                 Boolean    @default(false)
  lastLogin                DateTime?
  passwordResetToken       String?
  passwordResetTokenExpiry DateTime?
  createdAt                DateTime   @default(now())
  properties               Property[]

  @@map("user")
}

model Property {
  id          String          @id @default(cuid())
  name        String
  type        PropertyType?
  price       Float
  area        Float? // kvadratura u mÂ²
  address     String?
  lat         Float? // latitude koordinata
  lng         Float? // longitude koordinata
  description String?         @db.Text // opis nekretnine
  image       String? // URL glavne slike nekretnine
  status      PropertyStatus  @default(IN_REVIEW) // status odobrenja nekretnine
  promoted    Boolean         @default(false) // izdvojena nekretnina
  createdAt   DateTime        @default(now())
  ownerId     String
  owner       User            @relation(fields: [ownerId], references: [id])
  gallery     PropertyImage[] // galerija slika

  @@map("property")
}

model PropertyImage {
  id         String   @id @default(cuid())
  url        String // URL slike
  alt        String? // alt text za sliku
  caption    String? // opis slike
  order      Int      @default(0) // redosled prikaza
  propertyId String
  property   Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  createdAt  DateTime @default(now())

  @@index([propertyId])
  @@map("propertyimage")
}

model News {
  id          String   @id @default(cuid())
  title       String
  description String   @db.Text
  image       String? // URL slike vesti
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("news")
}

model Settings {
  id             String   @id @default(cuid())
  appName        String
  appDescription String   @db.Text
  address        String
  phone          String
  email          String
  logo_dark      String? // URL or path to dark mode logo image
  logo_light     String? // URL or path to light mode logo image
  lat            Float? // latitude koordinata
  lng            Float? // longitude koordinata
  facebook       String? // Facebook page URL
  instagram      String? // Instagram profile URL
  x              String? // X (Twitter) profile URL
  linkedin       String? // LinkedIn company page URL
  youtube        String? // YouTube channel URL
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@map("settings")
}
